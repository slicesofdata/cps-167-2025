save_plot_png(
plot = web_graph_1,
file_name = "Unemployment_Duration Distribution_by_Veteran_Status.png",
figs_dir = "src/figs",
units = "px",
width = 9000,
height = 3000,
dpi = 300
)
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
ggforce::geom_sina(seed = 167,   # make reproducible
size = .7,    # smaller than default
alpha = .07,
position = position_dodge2()# a little transparent
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
)
)+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
ggforce::geom_sina(seed = 167,   # make reproducible
size = .7,    # smaller than default
alpha = .07,
position = position_jitter()# a little transparent
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
)
)+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
#ggforce::geom_sina(seed = 167,   # make reproducible
#  size = .7,    # smaller than default
#  alpha = .07,
#  position = position_jitter()# a little transparent
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
)
)+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
#ggforce::geom_sina(seed = 167,   # make reproducible
#  size = .7,    # smaller than default
#  alpha = .07,
#  position = position_jitter()# a little transparent
# ) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
)
)+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
)+
scale_x_continuous(breaks = seq(0, 60, by = 5))+
)+
web_graph_1
scale_x_continuous(breaks = seq(0, 60, by = 5))+
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
))+
scale_x_continuous(breaks = seq(0, 60, by = 5))+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
))+
scale_x_discrete(breaks = seq(0, 60, by = 5))+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
))+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1
web_graph_1 <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
ggplot(aes(x = peafever , y = pelaydur, fill = peafever)) +
geom_violin()+
labs(
title = "Unemployment Duration Density Distribution",
x = "Veteran Status",
y = "Unemployment Duration (weeks)"
) +
scale_y_continuous(breaks = seq(0, 50, by = 5))+
coord_flip()+
scale_fill_manual(
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
))+
theme_minimal() +
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
theme(legend.position = "none")
web_graph_1
df_all_post_midterm|>
mode(unemployment duration)
df_all_post_midterm|>
mode(pelaydur)
df_all_post_midterm|>
count(pelaydur)
print()
######################## finding mean
df_all_post_midterm|>
class(pelaydur)
head(df_all_post_midterm)
mean(df_all_post_midterm$pelaydur, na.rm = TRUE)
filtered <- df_all_post_midterm |>
filter(!is.na(pelaydur))
median(filtered$pelaydur)
save_plot_png(
plot = web_graph_1,
file_name = "Unemployment_Duration Distribution_by_Veteran_Status.png",
figs_dir = "src/figs",
units = "px",
width = 9000,
height = 3000,
dpi = 300
)
################################################################################
# website graph 2
web_graph_avg <- df_all |>
filter(response != -1 & !is.na(response))|>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup()|>
pivot_wider(
names_from = variable,
values_from = response
)|>
mutate(
peafever = factor(peafever, levels = c(1, 2), labels = c("Veteran", "Non-Veteran"))
)|>
mutate(
year = year + 2000)|>
filter(peafever %in% c("Veteran", "Non-Veteran"))|>
filter(pelaydur == 9)|>
ggplot(mapping = aes(fill= peafever, x= year, y= pelaydur))+
geom_bar(position="fill", stat = "identity")+
scale_fill_manual(
name = "Veteran Status",
values = c(
"Veteran" = "#1f78b4",        # blue
"Non-Veteran" = "#33a02c"     # green
)
)+
labs(
title = "Proportion of People Unemployed for 9 Weeks, 2020-2024",
x = "Year",
y = "Proportion"
) +
theme_minimal()+
theme(
plot.title      = element_text(color = "grey40"),
plot.subtitle   = element_text(color = "grey40"),
plot.caption    = element_text(color = "grey40"),
axis.title.x    = element_text(color = "grey40"),
axis.title.y    = element_text(color = "grey40"),
axis.text.x     = element_text(color = "grey40"),
axis.text.y     = element_text(color = "grey40"),
legend.title    = element_text(color = "grey40"),
legend.text     = element_text(color = "grey40")
)+
coord_flip()
web_graph_avg
save_plot_png(
plot = web_graph_avg,
file_name = "Median_proportion_plot.png",
figs_dir = "src/figs",
units = "px",
width = 2000,
height = 1300,
dpi = 300
)
df_all <- read_rds(file = here::here("data","processed", "df_all_cps.rds"))
df_all_post_midterm <- df_all |>
filter(response != -1 & !is.na(response)) |>
group_by(month, year, variable) |>
mutate(obs_id = row_number()) |>
ungroup() |>
pivot_wider(
names_from  = variable,
values_from = response
) |>
mutate(
peafever = factor(
peafever,
levels = c(1, 2),
labels = c("Veteran", "Non-Veteran")
)
) |>
mutate(
ptdtrace = forcats::fct_collapse(
as.factor(ptdtrace),
White           = "1",
Black           = "2",
`Native American` = "3",
Asian           = "4",
`Pacific Islander` = "5",
`Multi-racial`  = c(
"6","7","8","9","10","11","12","13","14","15",
"16","17","18","19","20","21","22","23","24","25","26"
)
)
) |>
mutate(
edu = dplyr::case_when(
peeduca %in% 31:34 ~ "Less than High School",
peeduca %in% 35:38 ~ "Some High School, No Diploma",
peeduca == 39      ~ "High School Graduate",
peeduca %in% 40:42 ~ "Some College or Associate Degree",
peeduca == 43      ~ "Bachelor’s Degree",
peeduca %in% c(44, 45) ~ "Master’s and Professional Degree",
peeduca > 45       ~ "Doctorate degree"
)
)
saveRDS(
df_all_post_midterm,
file = here::here("data", "processed", "cps_all_post_midterm.rds")
)
source("~/.active-rstudio-document", echo = TRUE)
source(here::here("src", "functions", "load-libraries.R"))
source(here::here("src", "functions", "cps_all_post_midterm.rds"))
